---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .sort((a, b) => +new Date(b.data.date as string) - +new Date(a.data.date as string));

const fmt = new Intl.DateTimeFormat('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
---
<Base title="Blog â€” Vibhav Misra">
  <section class="mx-auto max-w-6xl px-4 py-12">
    <h1 class="text-3xl font-semibold">Blog</h1>
    <ul class="mt-6 space-y-4">
      {posts.map((post) => {
        const dateStr = post.data.date ? fmt.format(new Date(post.data.date as string)) : null;
        return (
          <li>
            <a
              class="block rounded-xl border border-white/10 hover:border-white/20 p-5 bg-[var(--card)]"
              href={`/blog/${post.slug}/`}
            >
              <h3 class="text-lg font-semibold">{post.data.title}</h3>
              {dateStr && <p class="text-sm text-slate-400 mt-1">{dateStr}</p>}
              {post.data.description && (
                <p class="text-slate-300 mt-2">{post.data.description}</p>
              )}
            </a>
          </li>
        );
      })}
    </ul>
  </section>
</Base>
